<nav class="site-nav">
  <div class="site-nav__brand" aria-label="WxManBran brand mark">
    <img class="site-nav__brand-image"
         src="{{ '/assets/images/Hurricane_Flags.png' | relative_url }}"
         alt="Hurricane warning flags icon" />
    <span class="site-nav__brand-text" aria-hidden="true">WMB</span>
  </div>
  <ul class="site-nav__links">
    {% assign current = page.url | default: '/' | relative_url %}
    {% for item in site.data.nav %}
      {% assign item_url = item.url | relative_url %}
      {% assign normalized_current = current | replace: '//', '/' %}
      {% assign normalized_item = item_url | replace: '//', '/' %}
      <li>
        <a href="{{ item_url }}"
           class="nav-link{% if normalized_current == normalized_item %} is-active{% endif %}"
           {% if normalized_current == normalized_item %}aria-current="page"{% endif %}>
          {% if item.icon %}
            <span class="nav-icon" aria-hidden="true">{% include icon.html name=item.icon %}</span>
          {% endif %}
          <span class="nav-label">{{ item.title }}</span>
        </a>
      </li>
    {% endfor %}
    <li class="site-nav__item site-nav__item--settings">
      <details class="nav-gear" data-theme-gear>
        <summary class="nav-gear__button" aria-label="Theme settings">
          <span class="nav-gear__icon nav-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" role="presentation" focusable="false">
              <path d="M12 15.25a3.25 3.25 0 1 0 0-6.5 3.25 3.25 0 0 0 0 6.5Z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M20.5 13.46V10.6l-2.13-.53a6.35 6.35 0 0 0-.62-1.5l1.17-1.87-2.02-2.02-1.87 1.17c-.5-.24-1.03-.44-1.58-.58L12.4 3.5h-2.86l-.55 2.27c-.55.14-1.08.34-1.58.58L5.54 5.18 3.52 7.2l1.17 1.87c-.28.48-.5.98-.65 1.51l-2.04.5v2.86l2.13.53c.14.55.35 1.09.62 1.59l-1.17 1.87 2.02 2.02 1.87-1.17c.48.23.99.42 1.52.56l.55 2.24h2.86l.55-2.24c.52-.14 1.03-.33 1.52-.56l1.87 1.17 2.02-2.02-1.17-1.87c.27-.5.48-1.03.62-1.58l2.04-.5Z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </span>
          <span class="nav-label">Settings</span>
        </summary>
        <div class="nav-gear__panel">
          <button type="button"
                  class="theme-toggle__button"
                  data-theme-toggle
                  aria-pressed="false"
                  aria-label="Switch to dark mode"
                  title="Switch to dark mode">
            <span class="theme-toggle__track" aria-hidden="true">
              <span class="theme-toggle__label theme-toggle__label--day">Light</span>
              <span class="theme-toggle__thumb">
                <span class="theme-toggle__icon theme-toggle__icon--sun" aria-hidden="true">
                  <svg viewBox="0 0 24 24" role="presentation" focusable="false">
                    <circle cx="12" cy="12" r="4.25" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M12 2.5v3.2M12 18.3v3.2M4.54 4.54l2.26 2.26M17.2 17.2l2.26 2.26M2.5 12h3.2M18.3 12h3.2M4.54 19.46l2.26-2.26M17.2 6.8l2.26-2.26" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </span>
                <span class="theme-toggle__icon theme-toggle__icon--moon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" role="presentation" focusable="false">
                    <path d="M21 14.25a8.26 8.26 0 0 1-10.78-10.5 8.27 8.27 0 1 0 10.78 10.5Z" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </span>
              </span>
              <span class="theme-toggle__label theme-toggle__label--night">Dark</span>
            </span>
            <span class="visually-hidden" data-theme-toggle-text>Switch to dark mode</span>
          </button>
        </div>
      </details>
    </li>
  </ul>

  <!-- DESKTOP/TABLET gear: pinned far right, icon-only -->
  <details class="nav-gear nav-gear--desktop" data-theme-gear>
    <summary class="nav-gear__button" aria-label="Theme settings">
      <span class="nav-gear__icon nav-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" role="presentation" focusable="false">
          <path d="M12 15.25a3.25 3.25 0 1 0 0-6.5 3.25 3.25 0 0 0 0 6.5Z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
          <path d="M20.5 13.46V10.6l-2.13-.53a6.35 6.35 0 0 0-.62-1.5l1.17-1.87-2.02-2.02-1.87 1.17c-.5-.24-1.03-.44-1.58-.58L12.4 3.5h-2.86l-.55 2.27c-.55.14-1.08.34-1.58.58L5.54 5.18 3.52 7.2l1.17 1.87c-.28.48-.5.98-.65 1.51l-2.04.5v2.86l2.13.53c.14.55.35 1.09.62 1.59l-1.17 1.87 2.02 2.02 1.87-1.17c.48.23.99.42 1.52.56l.55 2.24h2.86l.55-2.24c.52-.14 1.03-.33 1.52-.56l1.87 1.17 2.02-2.02-1.17-1.87c.27-.5.48-1.03.62-1.58l2.04-.5Z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </span>
      <span class="nav-gear__label" aria-hidden="true">Settings</span>
    </summary>
    <div class="nav-gear__panel">
      <button type="button"
              class="theme-toggle__button"
              data-theme-toggle
              aria-pressed="false"
              aria-label="Switch to dark mode"
              title="Switch to dark mode">
        <span class="theme-toggle__track" aria-hidden="true">
          <span class="theme-toggle__label theme-toggle__label--day">Light</span>
          <span class="theme-toggle__thumb">
            <span class="theme-toggle__icon theme-toggle__icon--sun" aria-hidden="true">
              <svg viewBox="0 0 24 24" role="presentation" focusable="false">
                <circle cx="12" cy="12" r="4.25" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M12 2.5v3.2M12 18.3v3.2M4.54 4.54l2.26 2.26M17.2 17.2l2.26 2.26M2.5 12h3.2M18.3 12h3.2M4.54 19.46l2.26-2.26M17.2 6.8l2.26-2.26" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </span>
            <span class="theme-toggle__icon theme-toggle__icon--moon" aria-hidden="true">
              <svg viewBox="0 0 24 24" role="presentation" focusable="false">
                <path d="M21 14.25a8.26 8.26 0 0 1-10.78-10.5 8.27 8.27 0 1 0 10.78 10.5Z" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </span>
          </span>
          <span class="theme-toggle__label theme-toggle__label--night">Dark</span>
        </span>
        <span class="visually-hidden" data-theme-toggle-text>Switch to dark mode</span>
      </button>
    </div>
  </details>
</nav>
